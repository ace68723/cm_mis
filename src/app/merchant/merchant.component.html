    <!-- begin:: Page -->
    <div class="m-grid m-grid--hor m-grid--root m-page">
        <app-header></app-header>
        <div class="m-grid__item m-grid__item--fluid m-grid m-grid--ver-desktop m-grid--desktop m-body">
            <app-sidebar></app-sidebar>
            <div class="m-content" style="width:100%; height: 100%">
                <div class="m-content" style="width:100%">
            
                    <div class="m-portlet m-portlet--mobile">
                        <div class="m-portlet__head">
                            <div class="m-portlet__head-caption">
                                <div class="m-portlet__head-title">
                                    <h3 class="m-portlet__head-text">
                                        {{name}}
                                    </h3>
                                </div>
                            </div>
                            
                        </div>
                        <div class="m-portlet__body">
                            
                            <ul class="nav nav-pills nav-pills--success" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#m_tabs_4_2" (click) = 'getDishRank()'>
                                        菜单Rank修改
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#m_tabs_4_3" (click) = 'setCategoryToDevice()'>
                                        添加/删除菜单
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#m_tabs_4_4" (click) = 'setCategoryToChannel()'>
                                        二级菜单
                                    </a>
                                </li>
                            </ul>
                            <div class="tab-content">

                                <div class="tab-pane active" id="m_tabs_4_2" role="tabpanel" style="overflow:visible">
                                        <div class="m-section__content">
                                                <table class="table m-table m-table--head-separator-primary" >
                                                    <thead>
                                                    <tr>
                                                        <th>
                                                            ID
                                                        </th>
                                                        <th>
                                                            NAME
                                                        </th>
                                                        <th>
                                                            RANK
                                                        </th>
                                                        <th *ngIf="!editing">
                                                            Edit
                                                        </th>
                                                        
                                                        <th *ngIf="editing">
                                                            Save
                                                        </th>
                                                        <th *ngIf="editing">
                                                            Cancel 
                                                        </th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr  *ngFor="let item of dishRank; index as i;trackBy: i" [attr.data-index]="i" >
                                                            <td>
                                                                {{item.dt_id}}
                                                            </td>

                                                            <td *ngIf="!item.isEditing">
                                                                {{item.name}}                         
                                                            </td>
                                                            <td *ngIf="!!item.isEditing">
                                                                <input class = "form-control m-input" type="text" [(ngModel)]="item.name" >                         
                                                            </td>
                                                            
                                                            <td *ngIf="!item.isEditing">
                                                                {{item.level}}
                                                            </td>
                                                            <td *ngIf="!!item.isEditing">
                                                                <input  class = "form-control m-input" type="text" [(ngModel)]="item.level">                                                                    
                                                            </td>
                                                            <td *ngIf="!item.isEditing">
                                                                <button class="btn btn-warning"  (click)='startEditing(item)'>Edit</button>
                                                            </td>
            
                                                            <td *ngIf="!!item.isEditing">
                                                                <button class="btn btn-warning"  (click)='saveDishRank(item)'>save</button>
                                                            </td>
                                                            <td *ngIf="!!item.isEditing">
                                                                <button class="btn btn-warning"  (click)='cancelEditing(item)'>cancel</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table> 
                                                <button class= "btn btn-warning" (click)= 'saveToDatabase();' style="margin-right:20px">更改结束, 同步数据库</button>

                                                <br>                                                                                    
                                        </div>                               
                                </div>
                                <div class="tab-pane" id="m_tabs_4_3" role="tabpanel">
                                    <div class="m-section__content">
                                        <table class="table m-table m-table--head-separator-primary" >
                                            <thead>
                                            <tr>
                                                <th>
                                                    Device ID
                                                </th>
                                                <th>
                                                    Delete
                                                </th>
                                               
                                                <th *ngIf="!editing2">
                                                    Edit
                                                </th>
                                                <th *ngIf="!editing2">
                                                        Delete
                                                    </th>
                                                <th *ngIf="editing2">
                                                    Save
                                                </th>
                                                <th *ngIf="editing2">
                                                    Cancel 
                                                </th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr  *ngFor="let item of deviceInfo; index as i;trackBy: i" [attr.data-index]="i" >
                                                    <td *ngIf="!item.isEditing">
                                                        {{item.device_id}}
                                                    </td>
                                                    <td *ngIf="!!item.isEditing">
                                                        <input class = "form-control m-input" type="text" [(ngModel)]='item.device_id' scope="row"> 
                                                    </td>
                                                    <td *ngIf="!item.isEditing">
                                                        {{item.is_deleted}}
                                                    </td>
                                                    <td *ngIf="!!item.isEditing">
                                                        <input class = "form-control m-input" type="text" [(ngModel)]='item.is_deleted' scope="row"> 
                                                    </td>
                                                  
                                                    <td *ngIf="!item.isEditing">
                                                        <button class="btn btn-warning"  (click)='startEditing(item)'>edit</button>
                                                    </td>
                                                    <td *ngIf="!item.isEditing">
                                                        <button class="btn btn-danger" data-toggle="modal" data-target="#m_modal_5_2"  (click)='setDeleteDevice(item)'>Delete</button>
                                                    </td>
                                                    <td *ngIf="!!item.isEditing">
                                                        <button class="btn btn-warning"  (click)='saveEditingDevice(item)'>save</button>
                                                    </td>
                                                    <td *ngIf="!!item.isEditing">
                                                        <button class="btn btn-warning"  (click)='cancelEditing(item);setCategoryToDevice()'>cancel</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div style="display: inline-flex; margin-bottom:20px;" *ngFor="let item of pageNumArray;  index as i;trackBy: i" [attr.data-index]="i">
                                                <a [class.some-class]="i+1 === page_num" style="margin-right:7px" class="btn btn-outline-warning m-btn m-btn--icon m-btn--icon-only" (click) = 'goToPage(i)'>
                                                        <p style="height: 100%;
                                                        margin-top: 27%;">{{i+1}}</p>
                                                </a>
                                        </div>
                                        <br>
                                        <div style="display:inline-flex;">
                                            <button class= "btn btn-warning" (click)= 'newUser = true; addNewDevice();' style="margin-right:20px">Add New Device</button>
                                            <button class= "btn btn-warning" (click)= 'newUser = false;'>Cancel</button>
                                    </div>
                                    <p *ngIf="message" style="color:#ea7b21">Add New Device Successfully</p>
                                        <div *ngIf="newUser">
                                            <table class="table m-table m-table--head-separator-primary" >
                                                <thead>
                                                <tr>
                                                    <th>
                                                        Device ID
                                                    </th>
                                                    <th>
                                                        Action
                                                    </th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                    <tr  *ngFor="let item of newDeviceInfo; index as i;trackBy: i" [attr.data-index]="i" >                                              
                                                        <td>
                                                            <input class = "form-control m-input" type="text" [(ngModel)]="item.device_id" >                         
                                                        </td>
                                                        <td>
                                                            <button class="btn btn-warning"  (click)='saveNewDevice(item)'>Add</button>
                                                        </td>
                                                        
                                                    </tr>
                                                </tbody>
                                            </table> 
                                            
                                        </div>                                                      
                                </div>                       
                                </div>                              
                                <div class="tab-pane" id="m_tabs_4_4" role="tabpanel">
                                        <div class="m-section__content">
                                                <div>
                                                        <P>Alipay</P>
                                                        <hr>
                                                        <table class="table m-table m-table--head-separator-primary" >
                                                            <thead>
                                                            <tr>
                                                                <th>
                                                                    Ali Rate
                                                                </th>
                                                               
                                                                <th>
                                                                    <div >
                                                                            Industry Code
                                                                            <a style = 'padding: 0;
                                                                            padding-left: 10px;' target="_blank" href="https://global.alipay.com/help/online/81" class="btn">
                                                                                <i class="flaticon-info"></i>
                                                                            </a> 
                                                                    </div>    
                                                                </th>
                                                               
                                                                <th *ngIf="!editing2">
                                                                    Edit
                                                                </th>
                                                                <th *ngIf="editing2">
                                                                    Save
                                                                </th>
                                                                <th *ngIf="editing2">
                                                                    Cancel 
                                                                </th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr  *ngFor="let item of aliInfo; index as i;trackBy: i" [attr.data-index]="i" >
                                                                    <td *ngIf="!item.isEditing" scope="row">
                                                                        {{item.rate}}
                                                                    </td>
                                                                    <td *ngIf="item.isEditing">
                                                                        <input class = "form-control m-input" type="text" [(ngModel)]='item.rate' scope="row"> 
                                                                    </td>
                                                                    <td *ngIf="!item.isEditing">
                                                                        {{item.sub_mch_industry}}
                                                                    </td>
                                                                    <td *ngIf="item.isEditing">
                                                                        <input class = "form-control m-input" type="text" [(ngModel)]="item.sub_mch_industry" >                         
                                                                    </td>
                                                                    <td *ngIf="!item.isEditing">
                                                                        <button class="btn btn-warning" class="btn btn-primary" (click)='startEditingAli(item)'>edit</button>
                                                                    </td>
                                                                    <td *ngIf="item.isEditing">
                                                                        <button class="btn btn-warning" class="btn btn-primary" (click)='saveEditingAli(item)'>save</button>
                                                                    </td>
                                                                    <td *ngIf="item.isEditing">
                                                                        <button class="btn btn-warning" class="btn btn-primary" (click)='cancelEditing(item);setCategoryToChannel()'>cancel</button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                </div>
                                                <div>
                                                        <P>Wechat</P>
                                                        <hr>
                                                        <table class="table m-table m-table--head-separator-primary" >
                                                                <thead>
                                                                <tr>
                                                                <th>
                                                                    Wechat Rate
                                                                </th>
                                                                <th>
                                                                    Merchant ID
                                                                </th>
                                                                
                                                                <th *ngIf="!editing3">
                                                                    Edit
                                                                </th>
                                                                <th *ngIf="!!editing3">
                                                                    Save
                                                                </th>
                                                                <th *ngIf="!!editing3">
                                                                    Cancel 
                                                                </th>
                                                            </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr  *ngFor="let item of wxInfo; index as i;trackBy: i" [attr.data-index]="i" >
                                                                        <td *ngIf="!item.isEditing" scope="row">
                                                                            {{item.rate}}
                                                                        </td>
                                                                        <td *ngIf="!!item.isEditing">
                                                                            <input class = "form-control m-input" type="text" [(ngModel)]='item.rate' scope="row"> 
                                                                        </td>
                                                                        
                                                                        <td *ngIf="!item.isEditing">
                                                                            {{item.sub_mch_id}}
                                                                        </td>
                                                                        <td *ngIf="!!item.isEditing">
                                                                            <input class = "form-control m-input"  type="text" [(ngModel)]="item.sub_mch_id" > 
                                                                        </td>
                                                                        <td *ngIf="!item.isEditing">
                                                                            <button class="btn btn-warning" class="btn btn-primary" (click)='startEditingWX(item)'>edit</button>
                                                                        </td>
                                                                        <td *ngIf="!!item.isEditing">
                                                                            <button class="btn btn-warning" class="btn btn-primary" (click)='saveEditingWX(item)'>save</button>
                                                                        </td>
                                                                        <td *ngIf="!!item.isEditing">
                                                                            <button class="btn btn-warning" class="btn btn-primary" (click)='cancelEditing(item)'>cancel</button>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>                                                                                   
        
                                                </div>
                                                <div style="display:inline-flex;">
                                                    <button class= "btn btn-warning" *ngIf="!ali" (click)= 'alic = true; addNewAliChannel();' style="margin-right:20px">Add Ali Pay</button>
                                                    <button class= "btn btn-warning" *ngIf="!wx" (click)= 'wxc = true; addNewWXChannel();' style="margin-right:20px">Add Wechat Pay</button>
                                                    <button class= "btn btn-warning" *ngIf="!ali||!wx"(click)= 'alic = false; wxc = false'>Cancel</button>
                                                </div>
                                                <p *ngIf="message" style="color:#ea7b21">Add New Device Successfully</p>
                                                <div *ngIf="alic">
                                                    <table class="table m-table m-table--head-separator-primary" >
                                                        <thead>
                                                        <tr>
                                                                <th>
                                                                    Rate
                                                                </th>
                                                                <th>
                                                                    Merchant ID
                                                                </th>
                                                                <th>
                                                                    Industry Code
                                                                </th>
                                                                <th>
                                                                    Action
                                                                </th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr  *ngFor="let item of newAliInfo; index as i;trackBy: i" [attr.data-index]="i" >
                                                                <td >
                                                                    <input class = "form-control m-input" type="text" [(ngModel)]='item.rate' scope="row"> 
                                                                </td>
                                                                <td >
                                                                    <input class = "form-control m-input"  type="text" [(ngModel)]="item.sub_mch_id" > 
                                                                </td>
                                                          
                                                                <td >
                                                                    <input class = "form-control m-input" type="text" [(ngModel)]="item.sub_mch_industry" >                         
                                                                </td>                                          
                                                                <td>
                                                                    <button class="btn btn-warning"  (click)='saveNewAli(item)'>Add</button>
                                                                </td>
                                                                
                                                            </tr>
                                                        </tbody>
                                                    </table> 
                                                </div> 
                                                <div *ngIf="wxc">
                                                    <table class="table m-table m-table--head-separator-primary" >
                                                        <thead>
                                                            <tr>
                                                                <th>
                                                                    Rate
                                                                </th>
                                                                <th>
                                                                    Merchant ID
                                                                </th>
                                                                <th>
                                                                    Action
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr  *ngFor="let item of newWXInfo; index as i;trackBy: i" [attr.data-index]="i" >
                                                                <td>
                                                                    <input class = "form-control m-input" type="text" [(ngModel)]='item.rate' scope="row"> 
                                                                </td>
                                                                <td>
                                                                    <input class = "form-control m-input" type="text" [(ngModel)]="item.sub_mch_id" >                         
                                                                </td>
                                                                <td>
                                                                    <button class="btn btn-warning"  (click)='saveNewWX(item)'>Add</button>
                                                                </td>
                                                                
                                                            </tr>
                                                        </tbody>
                                                    </table> 
                                                </div>              
                                        </div>                                    
                                </div>

                            </div>   
                        <!--end: Datatable -->
                        </div>
                    </div>
                    <div class="modal fade" id="m_modal_5_1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-sm" role="document" style="height: 100%;top: 30%;">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">
                                        Delete The User?
                                    </h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">
                                            &times;
                                        </span>
                                    </button>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-warning" data-dismiss="modal">
                                        No
                                    </button>
                                    <button type="button" class="btn btn-danger" data-dismiss="modal" (click) = 'deleteUser()'>
                                        Delete!
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="m_modal_5_2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-sm" role="document" style="height: 100%;top: 30%;">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">
                                        Delete The Device?
                                    </h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">
                                            &times;
                                        </span>
                                    </button>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-warning" data-dismiss="modal">
                                        No
                                    </button>
                                    <button type="button" class="btn btn-danger" data-dismiss="modal" (click) = 'deleteDevice()'>
                                        Delete!
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




